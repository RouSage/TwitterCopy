$(document).ready(function(){function t(n){n.addClass("d-none");n.prev(".btn-following-main").removeClass("d-none")}$("#deleteTweetModal").on("show.bs.modal",function(n){var i=$(n.relatedTarget),t=i.data("tweet-id"),r=$("#deleteTweetForm");r.attr("action",`/Index?handler=delete&id=${t}`);$.ajax({type:"GET",url:`/Index?handler=Tweet&id=${t}`,contentType:"application/json",dataType:"json",success:function(n){var t=$("#tweetInfoBody"),f;t.empty();var i=$('<ul class="list-inline">'),r=$('<li class="list-inline-item">').append(`<a href="/${n.authorSlug}">${n.authorName}</a>`),u=$('<li class="list-inline-item">').append(`<span class="text-muted">@${n.authorSlug}</span>`);i.append(r,u).appendTo(t);f=$("<p>").append(n.text).appendTo(t)},failure:function(n){alert(n)}})});$("#deleteTweetModal").on("hide.bs.modal",function(){var t=$("#deleteTweetForm"),n;t.removeAttr("action");n=$("#tweetInfoBody");n.empty()});$(document.body).on("click",".btn-like",function(n){n.preventDefault();var t=$(this),i=t.data("tweet-id");$.ajax({type:"GET",url:`/Index?handler=UpdateLikes&id=${i}`,contentType:"application/json",dataType:"json",success:function(n){var i=t.find("span");i.text(`${n}`)},failure:function(n){console.log(n)}})});$("#sendTweetForm input[type=submit]").prop("disabled",!0);$("#sendTweetForm input[type=submit]").hide();$("#sendTweetForm").focusin(function(){$("#sendTweetForm input[type=submit]").show()});$("#sendTweetForm").focusout(function(){$(this).find("input[type = text]").val().trim()||$("#sendTweetForm input[type=submit]").hide()});$("#sendTweetForm input[type=text]").keyup(function(){var n=$("#sendTweetForm input[type=submit]");$(this).val().trim()?n.prop("disabled",!1):n.prop("disabled",!0)});$(document.body).on("mouseleave",".btn-unfollow-main",function(n){var i=$(n.currentTarget);i.hasClass("d-none")||t(i)});$(document.body).on("mouseenter",".btn-following-main",function(){$(this).addClass("d-none");$(this).next(".btn-unfollow-main").removeClass("d-none")});$(document.body).on("click",".btn-follow-main",function(n){n.preventDefault();var t=$(this),i=$("#profileInfoSlug").data("slug"),u=t.find("span").data("userslug"),r=t.next(".btn-following-main"),f=r.next(".btn-unfollow-main");$.ajax({type:"POST",url:`/Index/?handler=Follow&userSlug=${u}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){t.addClass("d-none");r.removeClass("d-none");i===n.slug?$("#followersCount").text(n.count):i===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(n){alert(JSON.parse(JSON.stringify(n.responseJSON)).message)}})});$(document.body).on("click",".btn-unfollow-main",function(n){n.preventDefault();var t=$(this),i=$("#profileInfoSlug").data("slug"),r=t.find("span").data("userslug"),u=t.prev(".btn-following-main"),f=u.prev(".btn-follow-main");$.ajax({type:"POST",url:`/Index?handler=Unfollow&userSlug=${r}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){t.addClass("d-none");f.removeClass("d-none");i===n.slug?$("#followersCount").text(n.count):i===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(n){alert(JSON.parse(JSON.stringify(n.responseJSON)).message)}})});$(document.body).on("click",".btn-retweet",function(n){n.preventDefault();var t=$(this),i=t.data("tweet-id");$.ajax({type:"POST",url:`/Index?handler=Retweet&id=${i}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){var i=t.find("span");i.text(`${n}`)},failure:function(n){console.log(n)}})});var n={updateProfileInfo:function(n){$("#profileInfoUserName").text(n.username);$("#profileInfoBio").text(n.bio);$("#profileInfoLocation").text(n.location);$("#profileInfoWebsite").text(n.website)},saveChangesButtonClick:function(){$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none");$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none")},cancelButtonClick:function(){$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none");$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none")},editButtonClick:function(){$("#editProfileBtn").addClass("d-none");$("#cancelEditBtn").removeClass("d-none");$("#saveEditBtn").removeClass("d-none");$("#profileInfo").addClass("d-none");$("#profileEdit").removeClass("d-none")}};$("#editProfileBtn").click(function(t){t.preventDefault();n.editButtonClick()});$("#cancelEditBtn").click(function(t){t.preventDefault();n.cancelButtonClick()});$("#saveEditBtn").click(function(){var r=$('input:hidden[name="__RequestVerificationToken"]').val(),u=$('input[name="userName"]').val(),f=$('input[name="bio"]').val(),e=$('input[name="location"]').val(),o=$('input[name="website"]').val(),t={},i;t.__RequestVerificationToken=r;t.UserName=u;t.Bio=f;t.Location=e;t.Website=o;i="/Profiles/Index?handler=EditUser";$.post(i,t,function(t){n.updateProfileInfo(t);n.saveChangesButtonClick()}).fail(function(n){alert(JSON.parse(JSON.stringify(n.responseJSON)).message)})});$(".tweet-actionable").click(function(){var n=$(this),t=n.data("tweet-id"),i=n.data("user-slug");$.ajax({type:"GET",url:`/Profiles/Index/${i}`,data:{handler:"Status",tweetId:t},contentType:"application/json; charset=utf-8",success:function(n){var t=$("#tweetModal"),i=t.find(".modal-body");i.html(n);t.modal("show")},failure:function(n){alert(n)}})})});