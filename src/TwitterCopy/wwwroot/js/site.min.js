$(document).ready(function(){function i(n){n.addClass("d-none");n.prev(".btn-following-main").removeClass("d-none")}var t,n;$("#deleteTweetModal").on("show.bs.modal",function(t){var r=$(t.relatedTarget),i=r.data("tweet-id"),u=$("#deleteTweetForm");u.attr("action",`/Index?handler=delete&id=${i}`);$.ajax({type:"GET",url:`/Index?handler=Tweet&id=${i}`,contentType:"application/json",dataType:"json",success:function(n){var t=$("#tweetInfoBody"),f;t.empty();var i=$('<ul class="list-inline">'),r=$('<li class="list-inline-item">').append(`<a href="/${n.Slug}">${n.UserName}</a>`),u=$('<li class="list-inline-item">').append(`<span class="text-muted">@${n.Slug}</span>`);i.append(r,u).appendTo(t);f=$("<p>").append(n.text).appendTo(t)},failure:function(t){n.showAlertMessage(t)}})});$("#deleteTweetModal").on("hide.bs.modal",function(){var t=$("#deleteTweetForm"),n;t.removeAttr("action");n=$("#tweetInfoBody");n.empty()});$(document.body).on("click",".btn-like",function(t){t.preventDefault();var i=$(this),r=i.data("tweet-id");$.ajax({type:"GET",url:`/Index?handler=UpdateLikes&id=${r}`,contentType:"application/json",dataType:"json",success:function(n){var t=i.find("span");t.text(`${n}`)},failure:function(t){n.showAlertMessage(t)}})});$("#sendTweetForm input[type=submit]").prop("disabled",!0);$("#sendTweetForm input[type=submit]").hide();$("#sendTweetForm").focusin(function(){$("#sendTweetForm input[type=submit]").show()});$("#sendTweetForm").focusout(function(){$(this).find("input[type = text]").val().trim()||$("#sendTweetForm input[type=submit]").hide()});$("#sendTweetForm input[type=text]").keyup(function(){var n=$("#sendTweetForm input[type=submit]");$(this).val().trim()?n.prop("disabled",!1):n.prop("disabled",!0)});$(document.body).on("mouseleave",".btn-unfollow-main",function(n){var t=$(n.currentTarget);t.hasClass("d-none")||i(t)});$(document.body).on("mouseenter",".btn-following-main",function(){$(this).addClass("d-none");$(this).next(".btn-unfollow-main").removeClass("d-none")});$(document.body).on("click",".btn-follow-main",function(t){t.preventDefault();var i=$(this),r=$("#profileInfoSlug").data("slug"),f=i.find("span").data("userslug"),u=i.next(".btn-following-main"),e=u.next(".btn-unfollow-main");$.ajax({type:"POST",url:`/Index/?handler=Follow&userSlug=${f}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");u.removeClass("d-none");r===n.slug?$("#followersCount").text(n.count):r===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(t){n.showAlertMessage(JSON.parse(JSON.stringify(t.responseJSON)).message)}})});$(document.body).on("click",".btn-unfollow-main",function(t){t.preventDefault();var i=$(this),r=$("#profileInfoSlug").data("slug"),u=i.find("span").data("userslug"),f=i.prev(".btn-following-main"),e=f.prev(".btn-follow-main");$.ajax({type:"POST",url:`/Index?handler=Unfollow&userSlug=${u}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");e.removeClass("d-none");r===n.slug?$("#followersCount").text(n.count):r===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(t){n.showAlertMessage(JSON.parse(JSON.stringify(t.responseJSON)).message)}})});$(document.body).on("click",".btn-retweet",function(t){t.preventDefault();var i=$(this),r=i.data("tweet-id");$.ajax({type:"POST",url:`/Index?handler=Retweet&id=${r}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){var t=i.find("span");t.text(`${n}`)},failure:function(t){n.showAlertMessage(t)}})});t={updateProfileInfo:function(n){$("#profileInfoUserName").text(n.username);$("#profileInfoBio").text(n.bio);$("#profileInfoLocation").text(n.location);$("#profileInfoWebsite").text(n.website);$("#profileInfoAvatar").attr("src",n.avatar);$("#profileInfoBanner").attr("src",n.banner)},saveChangesButtonClick:function(){$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none");$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none")},cancelButtonClick:function(){$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none");$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none")},editButtonClick:function(){$("#editProfileBtn").addClass("d-none");$("#cancelEditBtn").removeClass("d-none");$("#saveEditBtn").removeClass("d-none");$("#profileInfo").addClass("d-none");$("#profileEdit").removeClass("d-none")},updateProfileAvatar:function(n){$("#profileInfoAvatar").attr("src",n)},updateProfileBanner:function(n){$("#profileInfoBanner").attr("src",n)}};$("#editProfileBtn").click(function(n){n.preventDefault();t.editButtonClick()});$("#cancelEditBtn").click(function(n){n.preventDefault();t.cancelButtonClick()});$("#saveEditBtn").click(function(){var r=$('input[name="userName"]').val(),u=$('input[name="bio"]').val(),f=$('input[name="location"]').val(),e=$('input[name="website"]').val(),o=$('input[name="Avatar"]')[0].files[0],s=$('input[name="Banner"]')[0].files[0],i=new FormData;i.append("userName",r);i.append("bio",u);i.append("location",f);i.append("website",e);i.append("avatar",o);i.append("banner",s);$.ajax({url:"/Profiles/Index?handler=EditUser",type:"POST",beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:!1,data:i,dataType:"json",cache:!1,processData:!1,success:function(n){t.updateProfileInfo(n);t.saveChangesButtonClick()},failure:function(){n.showAlertMessage(JSON.parse(JSON.stringify(jqXHR.responseJSON)).message)}})});$("#removeAvatarBtn").click(function(){var i=$("#profileInfoAvatar").data("avatar");$.ajax({url:"/Profiles/Index?handler=RemoveAvatar",type:"POST",beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},data:{avatar:i},dataType:"json",success:function(i){n.showAlertMessage(i.message);t.updateProfileAvatar(i.avatar)},error:function(t){n.showAlertMessage(JSON.parse(JSON.stringify(t.responseJSON)).message)}})});$("#removeBannerBtn").click(function(){var i=$("#profileInfoBanner").data("banner");$.ajax({url:"/Profiles/Index?handler=RemoveBanner",type:"POST",beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},data:{banner:i},dataType:"json",success:function(i){n.showAlertMessage(i.message);t.updateProfileBanner(i.banner)},error:function(t){n.showAlertMessage(JSON.parse(JSON.stringify(t.responseJSON)).message)}})});$(".tweet-actionable").click(function(t){var i=$(this),r=i.data("tweet-id"),u=i.data("user-slug");t.target.localName!=="button"&&t.target.localName!=="span"&&t.target.localName!=="a"&&t.target.localName!=="strong"&&t.target.localName!=="b"&&$.ajax({type:"GET",url:`/Profiles/Index/${u}`,data:{handler:"Status",tweetId:r},contentType:"application/json; charset=utf-8",success:function(n){var t=$("#tweetModal"),i=t.find(".modal-body");i.html(n);t.modal("show")},failure:function(t){n.showAlertMessage(t)}})});n={showAlertMessage:function(n){var t=$("#alertMessage"),i;t.removeClass("d-none");i=t.find(".message-text");i.text(n)},hideAlertMessage:function(){$("#alertMessage").addClass("d-none")}};$("#alertMessage .close").on("click",n.hideAlertMessage);$("#tweetModal").on("shown.bs.modal",function(){$("#sendReplyForm #sendReplyBtn").prop("disabled",!0);$("#sendReplyForm #sendReplyBtn").hide();$("#sendReplyForm").on("focusin",function(){$("#sendReplyForm #sendReplyBtn").show()});$("#sendReplyForm").on("focusout",function(){$(this).find("input[type=text]").val().trim()||$("#sendReplyForm #sendReplyBtn").hide()});$("#sendReplyForm input[type=text]").on("keyup",function(){var n=$("#sendReplyForm #sendReplyBtn");$(this).val().trim()?n.prop("disabled",!1):n.prop("disabled",!0)});$("#sendReplyBtn").on("click",function(){var n=$("#replyTextInput").val(),t=$(this).data("tweet-id");$.ajax({type:"POST",url:`/Profiles/Index?handler=Reply&replyText=${n}&tweetId=${t}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json; charset=utf-8",success:function(n){console.log(n)},failure:function(n){console.log(n)}})})})});