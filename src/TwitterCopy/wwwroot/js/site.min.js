$(document).ready(function(){function i(n){n.addClass("d-none");n.prev(".btn-following-main").removeClass("d-none")}var t,n;$(document.body).on("click",".btn-delete-tweet",function(){var i=$(this),t=i.data("tweet-id");$.ajax({type:"GET",url:"/Tweets/GetTweet",data:{id:t},success:function(n){var i=$("#deleteTweetModal"),r=i.find("#tweetInfoBody"),u=i.find("#confirmDeleteBtn");r.empty();r.html(n);u.attr("data-tweet-id",t);i.modal("show")},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$(document.body).on("click","#confirmDeleteBtn",function(){var i=$(this),r=i.data("tweet-id"),t=$("#deleteTweetModal");$.ajax({type:"POST",url:"/Tweets/Delete",data:{id:r},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(i){(t.hasClass(".show")||t.css("display")!=="none")&&t.modal("hide");var r=t.find("#tweetInfoBody");r.empty();n.showAlertMessage(i.message)},error:function(i){(t.hasClass(".show")||t.css("display")!=="none")&&t.modal("hide");n.showAlertMessage(i.responseJSON.message)}})});$("#deleteTweetModal").on("hide.bs.modal",function(){var n=$("#deleteTweetModal").find("#tweetInfoBody");n.empty()});$(document.body).on("click",".btn-like",function(t){t.preventDefault();var i=$(this),r=i.data("tweet-id");$.ajax({type:"GET",url:"/Tweets/UpdateLikes",data:{id:r},dataType:"json",success:function(n){var t=i.find("span");t.text(`${n}`)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$("#sendTweetForm input[type=submit]").prop("disabled",!0);$("#sendTweetForm input[type=submit]").hide();$("#sendTweetForm").focusin(function(){$("#sendTweetForm input[type=submit]").show()});$("#sendTweetForm").focusout(function(){$(this).find("input[type = text]").val().trim()||$("#sendTweetForm input[type=submit]").hide()});$("#sendTweetForm input[type=text]").keyup(function(){var n=$("#sendTweetForm input[type=submit]");$(this).val().trim()?n.prop("disabled",!1):n.prop("disabled",!0)});$(document.body).on("mouseleave",".btn-unfollow-main",function(n){var t=$(n.currentTarget);t.hasClass("d-none")||i(t)});$(document.body).on("mouseenter",".btn-following-main",function(){$(this).addClass("d-none");$(this).next(".btn-unfollow-main").removeClass("d-none")});$(document.body).on("click",".btn-follow-main",function(t){t.preventDefault();var i=$(this),r=$("#profileInfoSlug").data("slug"),u=i.find("span").data("userslug"),f=i.next(".btn-following-main");$.ajax({type:"POST",url:`/Index/?handler=Follow&userSlug=${u}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");f.removeClass("d-none");r===n.slug?$("#followersCount").text(n.count):r===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$(document.body).on("click",".btn-unfollow-main",function(t){t.preventDefault();var i=$(this),r=$("#profileInfoSlug").data("slug"),u=i.find("span").data("userslug"),f=i.prev(".btn-following-main"),e=f.prev(".btn-follow-main");$.ajax({type:"POST",url:`/Index?handler=Unfollow&userSlug=${u}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");e.removeClass("d-none");r===n.slug?$("#followersCount").text(n.count):r===n.currentUserSlug&&$("#followingCount").text(n.count)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$(document.body).on("click",".btn-retweet",function(t){t.preventDefault();var i=$(this),r=i.data("tweet-id");$.ajax({type:"POST",url:"/Tweets/Retweet",data:{id:r},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},dataType:"json",success:function(n){var t=i.find("span");t.text(`${n}`)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});t={updateProfileInfo:function(n){$("#profileInfoUserName").text(n.username);$("#profileInfoBio").text(n.bio);$("#profileInfoLocation").text(n.location);$("#profileInfoWebsite").text(n.website);$("#profileInfoAvatar").attr("src",n.avatar);$("#profileInfoBanner").attr("src",n.banner)},saveChangesButtonClick:function(){$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none");$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none")},cancelButtonClick:function(){$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none");$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none")},editButtonClick:function(){$("#editProfileBtn").addClass("d-none");$("#cancelEditBtn").removeClass("d-none");$("#saveEditBtn").removeClass("d-none");$("#profileInfo").addClass("d-none");$("#profileEdit").removeClass("d-none")},updateProfileAvatar:function(n){$("#profileInfoAvatar").attr("src",n)},updateProfileBanner:function(n){$("#profileInfoBanner").attr("src",n)}};$("#editProfileBtn").click(function(n){n.preventDefault();t.editButtonClick()});$("#cancelEditBtn").click(function(n){n.preventDefault();t.cancelButtonClick()});$("#saveEditBtn").click(function(){var r=$('input[name="userName"]').val(),u=$("#profileInfoSlug"),f=$('input[name="bio"]').val(),e=$('input[name="location"]').val(),o=$('input[name="website"]').val(),s=$('input[name="Avatar"]')[0].files[0],h=$('input[name="Banner"]')[0].files[0],i=new FormData;i.append("userName",r);i.append("slug",u);i.append("bio",f);i.append("location",e);i.append("website",o);i.append("avatar",s);i.append("banner",h);$.ajax({type:"POST",url:"/Profile/EditUser",data:i,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:!1,dataType:"json",processData:!1,success:function(n){t.updateProfileInfo(n);t.saveChangesButtonClick()},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$("#removeAvatarBtn").click(function(){var i=$("#profileInfoAvatar").data("avatar");$.ajax({type:"POST",url:"/Profile/RemoveAvatar",data:{avatar:i},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},dataType:"json",success:function(i){n.showAlertMessage(i.message);t.updateProfileAvatar(i.avatar)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$("#removeBannerBtn").click(function(){var i=$("#profileInfoBanner").data("banner");$.ajax({type:"POST",url:"/Profile/RemoveBanner",data:{banner:i},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},dataType:"json",success:function(i){n.showAlertMessage(i.message);t.updateProfileBanner(i.banner)},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});$(document.body).on("click",".tweet-actionable",function(t){var r=$(this),u=r.data("tweet-id"),f=r.data("user-slug"),i=$("#tweetModal");i.css("display")!=="none"&&i.modal("hide");t.target.localName!=="button"&&t.target.localName!=="span"&&t.target.localName!=="a"&&t.target.localName!=="strong"&&t.target.localName!=="b"&&$.ajax({type:"GET",url:"/Tweets/GetStatus",data:{slug:f,tweetId:u},success:function(n){var t=i.find(".modal-body");t.html(n);i.modal("show")},error:function(t){n.showAlertMessage(t.responseJSON.message)}})});n={showAlertMessage:function(n){var t=$("#alertMessage"),i;t.removeClass("d-none");i=t.find(".message-text");i.text(n)},hideAlertMessage:function(){$("#alertMessage").addClass("d-none")}};$("#alertMessage .close").on("click",n.hideAlertMessage);$("#tweetModal").on("show.bs.modal",function(){var r=$("#tweetModal"),i=r.find("#sendReplyForm"),t=i.find("#sendReplyBtn");t.prop("disabled",!0);t.hide();i.on("focusin",function(){t.show()});i.on("focusout",function(){$(this).find("input[type=text]").val().trim()||t.hide()});i.find("input[type=text]").on("keyup",function(){$(this).val().trim()?t.prop("disabled",!1):t.prop("disabled",!0)});t.on("click",function(){var t=i.find("input[type=text]").val(),u=$(this).data("tweet-id");$.ajax({type:"POST",url:"/Tweets/Reply",data:{replyText:t,tweetId:u},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},success:function(n){var t=r.find(".tweet-replies-from");t.prepend(n);i.find("input[type=text]").val("")},error:function(t){n.showAlertMessage(t.responseJSON.message)}})})});$('#selectLanguageForm button[type="button"]').on("click",function(){var n=$("#selectLanguageForm"),t=n.data("return-url"),i=n.find("select option:selected").val();$.ajax({type:"POST",url:"/Profile/SetLanguage",data:{culture:i,returnUrl:t},beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())}})})});