$(document).ready(function(){function t(){$(".btn-unfollow-main").addClass("d-none");$(".btn-following-main").removeClass("d-none")}$("#deleteTweetModal").on("show.bs.modal",function(n){var i=$(n.relatedTarget),t=i.data("tweet"),r=$("#deleteTweetForm");r.attr("action",`/Index?handler=delete&id=${t}`);$.ajax({type:"GET",url:`/Index?handler=Tweet&id=${t}`,contentType:"application/json",dataType:"json",success:function(n){var t=$("#tweetInfoBody"),f;t.empty();var i=$('<ul class="list-inline">'),r=$('<li class="list-inline-item">').append(`<a href="/${n.authorSlug}">${n.authorName}</a>`),u=$('<li class="list-inline-item">').append(`<span class="text-muted">@${n.authorSlug}</span>`);i.append(r,u).appendTo(t);f=$("<p>").append(n.text).appendTo(t)},failure:function(n){alert(n)}})});$("#deleteTweetModal").on("hide.bs.modal",function(){var t=$("#deleteTweetForm"),n;t.removeAttr("action");n=$("#tweetInfoBody");n.empty()});$(".btn-like").click(function(n){n.preventDefault();var t=$(this),i=t.data("id");$.ajax({type:"GET",url:`/Index?handler=UpdateLikes&id=${i}`,contentType:"application/json",dataType:"json",success:function(n){var i=t.find("span");i.text(`${n}`)},failure:function(n){console.log(n)}})});$("#sendTweetForm input[type=submit]").prop("disabled",!0);$("#sendTweetForm input[type=submit]").hide();$("#sendTweetForm").focusin(function(){$("#sendTweetForm input[type=submit]").show()});$("#sendTweetForm").focusout(function(){$(this).find("input[type = text]").val().trim()||$("#sendTweetForm input[type=submit]").hide()});$("#sendTweetForm input[type=text]").keyup(function(){var n=$("#sendTweetForm input[type=submit]");$(this).val().trim()?n.prop("disabled",!1):n.prop("disabled",!0)});$(".btn-unfollow-main").on("mouseleave",t);$(".btn-following-main").mouseenter(function(){$(this).addClass("d-none");$(".btn-unfollow-main").removeClass("d-none")});$(".btn-follow-main").click(function(n){n.preventDefault();var i=$(this),r=i.find("span").data("userslug");$.ajax({type:"POST",url:`/Index/?handler=Follow&userSlug=${r}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");$(".btn-following-main").removeClass("d-none");$(".btn-unfollow-main").on("mouseleave",t);$("#followersCount span").text(n)}})});$(".btn-unfollow-main").click(function(n){n.preventDefault();var i=$(this),r=i.find("span").data("userslug");$.ajax({type:"POST",url:`/Index?handler=Unfollow&userSlug=${r}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val());i.off("mouseleave")},contentType:"application/json",dataType:"json",success:function(n){i.addClass("d-none");$(".btn-follow-main").removeClass("d-none");$("#followersCount span").text(n)},failure:function(n){console.log(n);i.on("mouseleave",t)}})});$(".btn-retweet").click(function(n){n.preventDefault();var t=$(this),i=t.data("id");$.ajax({type:"POST",url:`/Index?handler=Retweet&id=${i}`,beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},contentType:"application/json",dataType:"json",success:function(n){var i=t.find("span");i.text(`${n}`)},failure:function(n){console.log(n)}})});var n={updateProfileInfo:function(n){$("#profileInfoUserName").text(n.username);$("#profileInfoBio").text(n.bio);$("#profileInfoLocation").text(n.location);$("#profileInfoWebsite").text(n.website)},saveChangesButtonClick:function(){$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none");$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none")},cancelButtonClick:function(){$("#cancelEditBtn").addClass("d-none");$("#saveEditBtn").addClass("d-none");$("#editProfileBtn").removeClass("d-none");$("#profileEdit").addClass("d-none");$("#profileInfo").removeClass("d-none")},editButtonClick:function(){$("#editProfileBtn").addClass("d-none");$("#cancelEditBtn").removeClass("d-none");$("#saveEditBtn").removeClass("d-none");$("#profileInfo").addClass("d-none");$("#profileEdit").removeClass("d-none")}};$("#editProfileBtn").click(function(t){t.preventDefault();n.editButtonClick()});$("#cancelEditBtn").click(function(t){t.preventDefault();n.cancelButtonClick()});$("#saveEditBtn").click(function(){var r=$('input:hidden[name="__RequestVerificationToken"]').val(),u=$('input[name="userName"]').val(),f=$('input[name="bio"]').val(),e=$('input[name="location"]').val(),o=$('input[name="website"]').val(),t={},i;t.__RequestVerificationToken=r;t.UserName=u;t.Bio=f;t.Location=e;t.Website=o;i=window.location.pathname+"?handler=EditUser";$.post(i,t,function(t){n.updateProfileInfo(t);n.saveChangesButtonClick()}).fail(function(n){alert(JSON.parse(JSON.stringify(n.responseJSON)).message)})})});